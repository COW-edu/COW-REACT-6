# 📚 8주차 학습

# 1. JWT vs Session

## 1.1 구조 차이

### 🔹 Session 기반 구조
- 로그인 성공 시 서버가 `session_id → 사용자 정보`를 세션 저장소에 저장  
- 클라이언트에는 **session_id를 담은 쿠키** 전달  
- 이후 요청마다 쿠키(session_id)를 가지고 서버에서 사용자 상태 확인

**특징:**  
- 서버가 인증 정보를 보관하는 구조(stateful)  
- 로그아웃 시 서버에서 세션 즉시 무효화 가능  

---

### 🔹 JWT 기반 구조
- 로그인 성공 시 서버가 **JWT(토큰)** 생성해서 클라이언트에게 전달  
- 클라이언트는 토큰을 localStorage/cookie에 보관  
- 요청마다 `Authorization: Bearer <token>` 로 전달  
- 서버는 토큰 **서명(signature)** 만 검증 → 상태 저장 필요 없음

**특징:**  
- 클라이언트 중심 인증(stateless)  
- 서버는 인증 정보를 저장하지 않음 → 확장성이 뛰어남  

---

## 1.2 서버 상태관리 차이 (Stateful vs Stateless)

| 구분 | Session | JWT |
|------|---------|------|
| 상태 관리 | 서버가 사용자 상태 보관 | 서버는 상태 저장 X |
| 확장성 | 낮음 (서버 간 세션 공유 필요) | 높음 (토큰 검증만 하면 OK) |
| 서버 부담 | 세션 저장소 필요 | 토큰 검증만 수행 |

---

## 1.3 보안 차이

### 🔹 Session 보안
- HttpOnly + Secure 쿠키 적용 시 XSS, CSRF에 강함  
- 세션이 서버 내부에 있어 외부 노출 위험이 적음  
- 로그아웃 시 즉시 세션 삭제 가능 → 보안적 안정성 높음  

### 🔹 JWT 보안
- 토큰 자체에 사용자 정보 + 만료 시간(exp)이 포함됨  
- localStorage 저장 시 XSS에 취약  
- 한 번 발급하면 유효기간 동안 강제 무효화가 어려움  

---

## 1.4 정리 비교표

| 항목 | Session | JWT |
|------|---------|------|
| 저장 위치 | 서버 | 클라이언트 |
| 상태 | Stateful | Stateless |
| 보안 | 강함(HttpOnly 쿠키) | 저장 방식에 따라 취약(XSS) |
| 서버 확장성 | 낮음 | 높음 |
| 로그아웃 | 즉시 무효화 가능 | 강제 무효화 어려움 |
| 대표 사용처 | 금융, 공공, 관리자 | SPA, 모바일 API |

---

# 2. React Router 흐름

## 2.1 전체 구성

| 경로 | 설명 | 보호 여부 |
|------|--------|-----------|
| `/register` | 회원가입 페이지 | ❌ 공개 |
| `/login` | 로그인 페이지 | ❌ 공개 |
| `/todo` | Todo 메인 | ✅ ProtectedRoute |

---

## 2.2 각 라우트의 역할

- **/register**  
  회원가입 화면 → 가입 성공 시 `/login` 이동

- **/login**  
  로그인 화면 → 로그인 성공 시 `localStorage.token` 저장 → `/todo` 이동

- **/todo**  
  로그인 필요 → ProtectedRoute를 통과해야 렌더링됨

---

## 2.3 ProtectedRoute 역할

> 로그인 여부(token 존재 여부)를 기준으로 접근 허용/차단한다.

- token 없음 → `/login` 강제 이동  
- token 있음 → 자식 컴포넌트 렌더링  

**ProtectedRoute 동작 흐름**

**ProtectedRoute 동작 흐름**

1. 사용자 요청 URL이 `/todo`인지 확인  
2. ProtectedRoute 실행  
3. `localStorage.getItem("token")` 값 확인  
4.  
   - 토큰 없음 → `/login` 으로 이동  
   - 토큰 있음 → 해당 페이지(TodoPage) 렌더링  

---

## 2.4 전체 흐름 정리

### 🔹 회원가입 흐름
/register → 회원가입 성공 → navigate("/login")

### 🔹 로그인 흐름
/login → 로그인 성공 → token 저장 → navigate("/todo")

### 🔹 인증된 사용자 → Todo 접근
/todo → ProtectedRoute → token 존재 → TodoPage 렌더링

### 🔹 비로그인 사용자 → Todo 접근
/todo → ProtectedRoute → token 없음 → /login 이동

### 🔹 로그아웃
token 삭제 → navigate("/login")

---

# 3. 구현하면서 배운 점
- 백엔드에 비해서 코드 분리의 기준을 정하는 것이 더 어렵다고 느꼈다.
- 백엔드에 비해서 구현이 사용자에게 직접적으로 보여진다는 것이 쉽지 않다는 생각이 들었다.
- 구조 수정이나 리팩토링이 백엔드 보다 조금 더 품이 든다고 느껴졌다.
- 유지보수와 유저 편의성 외의 비기능을 찾기 어렵다는 생각이 들었다.